SELECT 
    s.cust,  -- Customer column
    s.prod,  -- Product column
    -- Average sales quantity for Spring (March, April, May)
    AVG(CASE WHEN EXTRACT(MONTH FROM s.date) IN (3, 4, 5) THEN s.quant END) AS avg_spring,
    -- Average sales quantity for Summer (June, July, August)
    AVG(CASE WHEN EXTRACT(MONTH FROM s.date) IN (6, 7, 8) THEN s.quant END) AS avg_summer,
    -- Average sales quantity for Fall (September, October, November)
    AVG(CASE WHEN EXTRACT(MONTH FROM s.date) IN (9, 10, 11) THEN s.quant END) AS avg_fall,
    -- Average sales quantity for Winter (December, January, February)
    AVG(CASE WHEN EXTRACT(MONTH FROM s.date) IN (12, 1, 2) THEN s.quant END) AS avg_winter,
    -- Average sales quantity for the whole year
    AVG(s.quant) AS avg_whole_year,
    -- Total sales quantity for the whole year
    SUM(s.quant) AS total_sales,
    -- Count of sales records for the whole year
    COUNT(s.quant) AS count_sales
FROM sales s
GROUP BY s.cust, s.prod
ORDER BY s.cust, s.prod;


  cust  |  prod  |      avg_spring      |      avg_summer      |       avg_fall       |      avg_winter      |    avg_whole_year    | total_sales | count_sales 
--------+--------+----------------------+----------------------+----------------------+----------------------+----------------------+-------------+-------------
 Boo    | Apple  | 544.5000000000000000 | 525.9130434782608696 | 476.3846153846153846 | 503.4642857142857143 | 511.3564356435643564 |      103294 |         202
 Boo    | Butter | 467.4838709677419355 | 495.5806451612903226 | 514.6129032258064516 | 483.3333333333333333 | 490.3089430894308943 |      120616 |         246
 Boo    | Cherry | 463.9615384615384615 | 577.4000000000000000 | 485.3181818181818182 | 425.5925925925925926 | 486.6600000000000000 |       97332 |         200
 Boo    | Dates  | 492.1944444444444444 | 443.1052631578947368 | 402.8461538461538462 | 483.1290322580645161 | 460.6160714285714286 |      103178 |         224
 Boo    | Eggs   | 555.8684210526315789 | 531.0000000000000000 | 400.6176470588235294 | 516.3714285714285714 | 501.5882352941176471 |      136432 |         272
 Boo    | Fish   | 497.8076923076923077 | 510.6818181818181818 | 518.3636363636363636 | 456.5454545454545455 | 495.9347826086956522 |       91252 |         184
 Boo    | Grapes | 582.9629629629629630 | 430.5294117647058824 | 418.0303030303030303 | 485.5517241379310345 | 473.6097560975609756 |      116508 |         246
 Boo    | Ham    | 526.4166666666666667 | 508.7000000000000000 | 544.0967741935483871 | 499.5416666666666667 | 520.6513761467889908 |      113502 |         218
 Boo    | Ice    | 467.0769230769230769 | 474.1538461538461538 | 463.8620689655172414 | 496.0625000000000000 | 472.7938144329896907 |       91722 |         194
 Boo    | Jelly  | 550.7826086956521739 | 437.2187500000000000 | 404.5588235294117647 | 491.7714285714285714 | 464.7258064516129032 |      115252 |         248
 Chae   | Apple  | 466.8846153846153846 | 514.3666666666666667 | 473.0000000000000000 | 502.6470588235294118 | 488.7029702970297030 |       98718 |         202
 Chae   | Butter | 413.7200000000000000 | 528.7619047619047619 | 471.1935483870967742 | 457.5000000000000000 | 475.3692307692307692 |      123596 |         260
 Chae   | Cherry | 528.9655172413793103 | 455.3437500000000000 | 422.1923076923076923 | 557.1304347826086957 | 488.2000000000000000 |      107404 |         220
 Chae   | Dates  | 563.8928571428571429 | 541.3333333333333333 | 482.5294117647058824 | 577.2068965517241379 | 538.4107142857142857 |      120604 |         224
 Chae   | Eggs   | 505.9166666666666667 | 504.4166666666666667 | 560.2812500000000000 | 481.3333333333333333 | 515.6355140186915888 |      110346 |         214
 Chae   | Fish   | 429.4000000000000000 | 519.7241379310344828 | 439.0833333333333333 | 464.8400000000000000 | 461.5166666666666667 |      110764 |         240
 Chae   | Grapes | 584.1600000000000000 | 445.6666666666666667 | 465.1600000000000000 | 514.9230769230769231 | 499.9150943396226415 |      105982 |         212
 Chae   | Ham    | 503.8148148148148148 | 536.4615384615384615 | 458.9545454545454545 | 491.8800000000000000 | 499.4500000000000000 |       99890 |         200
 Chae   | Ice    | 552.8611111111111111 | 402.1153846153846154 | 536.6666666666666667 | 575.0322580645161290 | 521.9145299145299145 |      122128 |         234
 Chae   | Jelly  | 562.0000000000000000 | 492.7894736842105263 | 505.0000000000000000 | 532.6500000000000000 | 524.7872340425531915 |       98660 |         188
 Claire | Apple  | 404.3142857142857143 | 519.9354838709677419 | 444.2800000000000000 | 605.0000000000000000 | 479.5045871559633028 |      104532 |         218
 Claire | Butter | 486.1538461538461538 | 506.2000000000000000 | 567.3928571428571429 | 525.4615384615384615 | 519.0458015267175573 |      135990 |         262
 Claire | Cherry | 439.8437500000000000 | 530.6785714285714286 | 693.7200000000000000 | 492.0666666666666667 | 536.5800000000000000 |      107316 |         200
 Claire | Dates  | 503.3939393939393939 | 426.7083333333333333 | 420.4000000000000000 | 479.5185185185185185 | 465.7171717171717172 |       92212 |         198
 Claire | Eggs   | 431.1785714285714286 | 564.3333333333333333 | 389.3437500000000000 | 477.0344827586206897 | 462.0948275862068966 |      107206 |         232
 Claire | Fish   | 541.4545454545454545 | 436.7619047619047619 | 563.1481481481481481 | 656.0000000000000000 | 553.5425531914893617 |      104066 |         188
 Claire | Grapes | 524.3243243243243243 | 443.3000000000000000 | 580.0312500000000000 | 502.0909090909090909 | 521.3783783783783784 |      115746 |         222
 Claire | Ham    | 449.5925925925925926 | 534.2500000000000000 | 524.8888888888888889 | 517.7500000000000000 | 507.4260869565217391 |      116708 |         230
 Claire | Ice    | 502.0434782608695652 | 545.9615384615384615 | 406.9200000000000000 | 526.5555555555555556 | 496.3564356435643564 |      100264 |         202
 Claire | Jelly  | 493.4615384615384615 | 488.4137931034482759 | 637.8800000000000000 | 419.8928571428571429 | 506.4629629629629630 |      109396 |         216
 Dan    | Apple  | 472.6857142857142857 | 488.7241379310344828 | 484.6129032258064516 | 527.9200000000000000 | 491.1500000000000000 |      117876 |         240
 Dan    | Butter | 500.2758620689655172 | 540.3103448275862069 | 469.0666666666666667 | 441.3225806451612903 | 486.8067226890756303 |      115860 |         238
 Dan    | Cherry | 415.3600000000000000 | 537.7575757575757576 | 498.9000000000000000 | 496.7741935483870968 | 490.8990825688073394 |      107016 |         218
 Dan    | Dates  | 473.5250000000000000 | 485.1707317073170732 | 498.4736842105263158 | 537.8928571428571429 | 495.4829931972789116 |      145672 |         294
 Dan    | Eggs   | 493.1200000000000000 | 515.3333333333333333 | 495.5925925925925926 | 558.5238095238095238 | 513.5728155339805825 |      105796 |         206
 Dan    | Fish   | 525.8787878787878788 | 491.9047619047619048 | 572.7619047619047619 | 535.1071428571428571 | 531.0194174757281553 |      109390 |         206
 Dan    | Grapes | 485.4444444444444444 | 524.0769230769230769 | 502.8181818181818182 | 439.0000000000000000 | 488.7500000000000000 |      109480 |         224
 Dan    | Ham    | 521.1250000000000000 | 546.6176470588235294 | 481.8000000000000000 | 419.4782608695652174 | 497.2432432432432432 |      110388 |         222
 Dan    | Ice    | 484.8750000000000000 | 566.2121212121212121 | 584.6363636363636364 | 539.4583333333333333 | 548.7894736842105263 |      125124 |         228
 Dan    | Jelly  | 544.6250000000000000 | 511.1875000000000000 | 582.4400000000000000 | 581.1000000000000000 | 550.6138613861386139 |      111224 |         202
 Emily  | Apple  | 468.7407407407407407 | 494.6785714285714286 | 467.0312500000000000 | 486.8250000000000000 | 479.7244094488188976 |      121850 |         254
 Emily  | Butter | 465.7391304347826087 | 521.9200000000000000 | 439.4857142857142857 | 584.4242424242424242 | 503.6896551724137931 |      116856 |         232
 Emily  | Cherry | 500.2608695652173913 | 535.4000000000000000 | 492.3529411764705882 | 489.6875000000000000 | 499.4903846153846154 |      103894 |         208
 Emily  | Dates  | 385.6896551724137931 | 566.0714285714285714 | 502.6785714285714286 | 489.5600000000000000 | 484.9909090909090909 |      106698 |         220
 Emily  | Eggs   | 439.7187500000000000 | 443.5925925925925926 | 439.5526315789473684 | 383.0952380952380952 | 430.4745762711864407 |      101592 |         236
 Emily  | Fish   | 361.0454545454545455 | 482.3125000000000000 | 501.4814814814814815 | 424.0588235294117647 | 446.3913043478260870 |      102670 |         230
 Emily  | Grapes | 556.9565217391304348 | 394.3200000000000000 | 495.9629629629629630 | 475.0000000000000000 | 479.4742268041237113 |       93018 |         194
 Emily  | Ham    | 520.0909090909090909 | 502.4250000000000000 | 538.3589743589743590 | 383.2083333333333333 | 495.9779411764705882 |      134906 |         272
 Emily  | Ice    | 429.0476190476190476 | 437.3913043478260870 | 390.2758620689655172 | 550.4761904761904762 | 446.2553191489361702 |       83896 |         188
 Emily  | Jelly  | 384.4333333333333333 | 484.2800000000000000 | 500.0454545454545455 | 427.5517241379310345 | 443.7735849056603774 |       94080 |         212
 Helen  | Apple  | 612.3000000000000000 | 598.8108108108108108 | 538.0000000000000000 | 502.5000000000000000 | 569.1958762886597938 |      110424 |         194
 Helen  | Butter | 498.0400000000000000 | 523.6250000000000000 | 460.5925925925925926 | 339.8095238095238095 | 464.5619047619047619 |       97558 |         210
 Helen  | Cherry | 511.0000000000000000 | 485.8437500000000000 | 476.7666666666666667 | 502.0789473684210526 | 493.6320000000000000 |      123408 |         250
 Helen  | Dates  | 521.2307692307692308 | 404.6250000000000000 | 568.3333333333333333 | 513.4375000000000000 | 512.8811881188118812 |      103602 |         202
 Helen  | Eggs   | 504.6666666666666667 | 556.4761904761904762 | 489.7058823529411765 | 478.2413793103448276 | 503.0683760683760684 |      117718 |         234
 Helen  | Fish   | 420.7941176470588235 | 590.1481481481481481 | 605.2142857142857143 | 499.0909090909090909 | 524.0270270270270270 |      116334 |         222
 Helen  | Grapes | 504.6000000000000000 | 483.6315789473684211 | 500.5000000000000000 | 507.3666666666666667 | 500.1782178217821782 |      101036 |         202
 Helen  | Ham    | 476.7741935483870968 | 456.5625000000000000 | 492.0800000000000000 | 391.6451612903225806 | 452.3781512605042017 |      107666 |         238
 Helen  | Ice    | 544.6400000000000000 | 544.9629629629629630 | 535.8095238095238095 | 411.3478260869565217 | 515.3418803418803419 |      120590 |         234
 Helen  | Jelly  | 491.4814814814814815 | 493.2333333333333333 | 594.9090909090909091 | 454.1764705882352941 | 500.8584070796460177 |      113194 |         226
 Mia    | Apple  | 499.9473684210526316 | 518.9354838709677419 | 456.3571428571428571 | 451.3333333333333333 | 482.7461538461538462 |      125514 |         260
 Mia    | Butter | 476.1363636363636364 | 494.0666666666666667 | 525.0344827586206897 | 507.8148148148148148 | 502.1666666666666667 |      108468 |         216
 Mia    | Cherry | 483.6400000000000000 | 416.4615384615384615 | 543.0000000000000000 | 469.7586206896551724 | 478.5327102803738318 |      102406 |         214
 Mia    | Dates  | 435.9642857142857143 | 537.1071428571428571 | 612.6800000000000000 | 423.4166666666666667 | 502.1428571428571429 |      105450 |         210
 Mia    | Eggs   | 471.8387096774193548 | 545.2857142857142857 | 489.1538461538461538 | 500.9687500000000000 | 503.7177419354838710 |      124922 |         248
 Mia    | Fish   | 543.2142857142857143 | 477.7692307692307692 | 476.0769230769230769 | 526.4137931034482759 | 507.1192660550458716 |      110552 |         218
 Mia    | Grapes | 465.6956521739130435 | 446.9090909090909091 | 428.4137931034482759 | 441.0689655172413793 | 444.2524271844660194 |       91516 |         206
 Mia    | Ham    | 513.3200000000000000 | 552.5238095238095238 | 510.6818181818181818 | 496.3333333333333333 | 516.5473684210526316 |       98144 |         190
 Mia    | Ice    | 550.2307692307692308 | 396.7142857142857143 | 607.2068965517241379 | 610.0555555555555556 | 534.6930693069306931 |      108008 |         202
 Mia    | Jelly  | 548.8000000000000000 | 581.8928571428571429 | 486.6562500000000000 | 516.5757575757575758 | 532.1953125000000000 |      136242 |         256
 Sam    | Apple  | 493.2380952380952381 | 498.8214285714285714 | 514.9393939393939394 | 514.0000000000000000 | 506.7192982456140351 |      115532 |         228
 Sam    | Butter | 501.0833333333333333 | 573.6666666666666667 | 516.0416666666666667 | 493.7857142857142857 | 523.0849056603773585 |      110894 |         212
 Sam    | Cherry | 518.7741935483870968 | 591.5000000000000000 | 506.6296296296296296 | 440.6666666666666667 | 515.8888888888888889 |      111432 |         216
 Sam    | Dates  | 497.7500000000000000 | 541.8235294117647059 | 519.6000000000000000 | 518.0000000000000000 | 520.4453781512605042 |      123866 |         238
 Sam    | Eggs   | 577.1470588235294118 | 488.0370370370370370 | 573.0833333333333333 | 485.6896551724137931 | 531.9210526315789474 |      121278 |         228
 Sam    | Fish   | 494.6451612903225806 | 479.5000000000000000 | 496.1428571428571429 | 476.5806451612903226 | 487.1818181818181818 |      107180 |         220
 Sam    | Grapes | 486.2916666666666667 | 558.0000000000000000 | 363.8461538461538462 | 454.9687500000000000 | 458.3366336633663366 |       92584 |         202
 Sam    | Ham    | 526.4230769230769231 | 494.4285714285714286 | 604.0000000000000000 | 406.8387096774193548 | 506.6347826086956522 |      116526 |         230
 Sam    | Ice    | 496.3214285714285714 | 478.5185185185185185 | 459.2666666666666667 | 601.7586206896551724 | 509.1754385964912281 |      116092 |         228
 Sam    | Jelly  | 575.4800000000000000 | 576.2333333333333333 | 533.0000000000000000 | 506.7500000000000000 | 546.4424778761061947 |      123496 |         226
 Wally  | Apple  | 504.7241379310344828 | 548.6129032258064516 | 564.6428571428571429 | 514.6666666666666667 | 534.5137614678899083 |      116524 |         218
 Wally  | Butter | 532.5217391304347826 | 655.3214285714285714 | 394.8709677419354839 | 379.0882352941176471 | 480.4051724137931034 |      111454 |         232
 Wally  | Cherry | 652.0434782608695652 | 515.5000000000000000 | 485.8181818181818182 | 495.3714285714285714 | 527.5371900826446281 |      127664 |         242
 Wally  | Dates  | 577.6774193548387097 | 499.3636363636363636 | 513.6000000000000000 | 441.8965517241379310 | 509.9732142857142857 |      114234 |         224
 Wally  | Eggs   | 555.5526315789473684 | 462.7000000000000000 | 548.2727272727272727 | 482.5806451612903226 | 515.4924242424242424 |      136090 |         264
 Wally  | Fish   | 492.5714285714285714 | 475.8571428571428571 | 609.9230769230769231 | 553.6666666666666667 | 528.2248062015503876 |      136282 |         258
 Wally  | Grapes | 469.5833333333333333 | 450.1935483870967742 | 559.7307692307692308 | 502.7692307692307692 | 493.9345794392523364 |      105702 |         214
 Wally  | Ham    | 552.0882352941176471 | 435.6086956521739130 | 570.4687500000000000 | 555.0909090909090909 | 533.8468468468468468 |      118514 |         222
 Wally  | Ice    | 575.6666666666666667 | 459.5789473684210526 | 462.3478260869565217 | 555.7000000000000000 | 515.0697674418604651 |       88592 |         172
 Wally  | Jelly  | 519.9629629629629630 | 540.8500000000000000 | 600.3157894736842105 | 528.4285714285714286 | 544.3563218390804598 |       94718 |         174
(90 rows)

